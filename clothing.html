<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./kids_shoes_cloth.css">
    <title>Kids's Clothing. Nike IN</title>
</head>
<body>
    <div id="women_shoe_main_div">
        <div id="women_shoes_filter_sort">
            <h1>Kid's clothes</h1>
            <div style="display: flex;">
                <select onchange="fiter_data()" id="fitler_women_shoe_clothing">
                    <option value="">Filter</option>
                    <option value="tracksuits">Tracksuits</option>
                    <option value="tops_tshirts">Tops & T-Shirts</option>
                    <option value="shorts">shorts</option>
                    <option value="jackets_vests">Jackets & vests</option>
                    <option value="hoodies">Hoodies</option>
                </select>
                <select onchange="sort_data()" id="sort_women_shoe_clothing">
                    <option value="">Sort</option>
                    <option value="low">Low-High</option>
                    <option value="high">High-low</option>
                </select>
            </div>
        </div>
        <div id="women_shoes_container"></div>
    </div>
</body>
</html>

<script>
        showfetch()
         async function showfetch(){
            let res=await fetch("https://myfirssstapinodejs.herokuapp.com/kidsCloth")
            let data = await res.json()
            showData(data);
        }
    
    
    function showData(data){
        var body = document.querySelector("#women_shoes_container");
                body.innerHTML = null;

        data.map(({product_name, product_image, product_description, product_category, product_price})=>{
            

            var div = document.createElement("div");
                div.addEventListener("click", function(event){
                    var obj = {
                        titleprod: product_name,
                        imageprod:product_image[0],
                        desprod: product_description,
                        catprod: product_category,
                        priceprod: product_price
                    };

                    var localobj = JSON.parse(localStorage.getItem("product"));

                    console.log(obj);

                    localStorage.setItem("product", JSON.stringify(obj));

                    window.location.href = "product_show.html";
                });
                    
                    var image  = document.createElement("img");
                        image.setAttribute("src",product_image[0] );
                        image.setAttribute("class", "women_prod_image");

                    var title = document.createElement("h2");
                        title.innerText = product_name;
                        title.style.marginLeft = "10px";

                    var price = document.createElement("p");
                        price.innerText = "â‚¹ "+product_price;
                        price.style.marginLeft = "10px";

                    div.append(image, title, price);

                    body.append(div);
                })
    }

    function fiter_data(){
        var selected = document.querySelector("#fitler_women_shoe_clothing").value;
        if(selected === ""){
            showData(data);
        }
        else{
            var filter = data.filter(({prodcat}) =>{
                return (prodcat == selected);
            });
            showData(filter);
        }
    }

    function sort_data(){
        var select = document.querySelector("#sort_women_shoe_clothing").value;

        setTimeout( function(){
            if(select === "low"){
                data.sort((a, b) => {
                    return a.prodprice - b.prodprice;
                })
            }
            if(select === "high"){
                data.sort((a, b)=>{
                    return b.prodprice - a.prodprice;
                })
            }

            showData(data)
        }, 1000);
    }
</script>